# 7.4 Aloca√ß√£o Din√¢mica de Mem√≥ria com `malloc()` e `free()` üìåüî¢

## Introdu√ß√£o

A aloca√ß√£o din√¢mica de mem√≥ria √© uma t√©cnica poderosa que permite alocar e liberar mem√≥ria durante a execu√ß√£o de um programa. Na linguagem C, podemos utilizar as fun√ß√µes `malloc()` e `free()` para realizar essa opera√ß√£o.

## Aloca√ß√£o Din√¢mica de Mem√≥ria üì¶üîß

A aloca√ß√£o din√¢mica de mem√≥ria nos permite reservar uma quantidade espec√≠fica de mem√≥ria durante a execu√ß√£o do programa. Isso √© √∫til quando n√£o sabemos antecipadamente o tamanho necess√°rio ou quando queremos criar estruturas de dados flex√≠veis, como listas encadeadas.

A fun√ß√£o `malloc()` (memory allocation) √© utilizada para alocar um bloco de mem√≥ria de tamanho espec√≠fico. Ela retorna um ponteiro para o in√≠cio do bloco alocado ou `NULL` caso a aloca√ß√£o n√£o seja bem-sucedida.

## Exemplo Imagin√°rio üåü

Vamos imaginar que estamos desenvolvendo um programa de gerenciamento de livros de uma biblioteca. Precisamos armazenar informa√ß√µes sobre os livros, como t√≠tulo, autor e ano de publica√ß√£o. Utilizaremos a aloca√ß√£o din√¢mica de mem√≥ria para criar uma estrutura de dados flex√≠vel, onde podemos adicionar ou remover livros conforme necess√°rio.

```c
typedef struct {
    char *titulo;
    char *autor;
    int anoPublicacao;
} Livro;

int main() {
    Livro *livro;

    livro = (Livro *)malloc(sizeof(Livro));

    if (livro != NULL) {
        livro->titulo = "Dom Quixote";
        livro->autor = "Miguel de Cervantes";
        livro->anoPublicacao = 1605;

        // Utilize o livro

        free(livro);
    }

    return 0;
}
```

Neste exemplo, declaramos uma estrutura `Livro` contendo campos para o t√≠tulo, autor e ano de publica√ß√£o. Em seguida, declaramos um ponteiro `livro` e utilizamos a fun√ß√£o `malloc()` para alocar mem√≥ria para a estrutura `Livro`. Se a aloca√ß√£o for bem-sucedida, podemos utilizar o ponteiro para acessar e manipular os campos do livro. Por fim, utilizamos a fun√ß√£o `free()` para liberar a mem√≥ria alocada quando n√£o precisamos mais dela.

## Exemplo Pr√°tico: Aloca√ß√£o Din√¢mica de um Array de Inteiros üìä

Vamos ver um exemplo pr√°tico de como alocar dinamicamente um array de inteiros e liberar a mem√≥ria alocada quando n√£o precisamos mais dela:

```c
#include <stdio.h>
#include <stdlib.h>

int main() {
    int *numeros;
    int tamanho;

    printf("Informe o tamanho do array: ");
    scanf("%d", &tamanho);

    numeros = (int *)malloc(tamanho * sizeof(int));

    if (numeros != NULL) {
        printf("Informe os n√∫meros:\n");
        for (int i = 0; i < tamanho; i++) {
            scanf("%d", &numeros[i]);
        }

        printf("N√∫meros informados: ");
        for (int i = 0; i < tamanho; i++) {
            printf("%d ", numeros[i]);
        }

        free(numeros);
    }

    return 0;
}
```

Neste exemplo, pedimos ao usu√°rio para informar o tamanho do array de inteiros. Em seguida, alocamos dinamicamente a mem√≥ria necess√°ria para o array utilizando `malloc()`. Depois, lemos os n√∫meros informados pelo usu√°rio e imprimimos na tela. Por fim, utilizamos `free()` para liberar a mem√≥ria alocada.

## Exerc√≠cios Pr√°ticos üí°üî¢

1. Escreva um programa que utilize a aloca√ß√£o din√¢mica de mem√≥ria para criar uma lista encadeada de n√∫meros inteiros.
2. Crie uma fun√ß√£o que receba um inteiro `n` e retorne um array din√¢mico contendo os `n` primeiros n√∫meros primos.

## Desafio de Pesquisa üîéüí°

Pesquise sobre a fun√ß√£o `realloc()` e descubra como utiliz√°-la para redimensionar um bloco de mem√≥ria alocado dinamicamente.

## Conclus√£o

A aloca√ß√£o din√¢mica de mem√≥ria com `malloc()` e a libera√ß√£o com `free()` s√£o recursos poderosos da linguagem C que nos permitem gerenciar a mem√≥ria durante a execu√ß√£o do programa. Essas fun√ß√µes nos d√£o flexibilidade para criar estruturas de dados din√¢micas e economizar recursos do sistema. No entanto, √© importante lembrar de liberar a mem√≥ria alocada quando n√£o precisamos mais dela, para evitar vazamentos de mem√≥ria.